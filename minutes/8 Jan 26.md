# Rumble FE&BE Team collab

## Action Items

- Implement /proxy/paymaster endpoint mirroring existing RPC proxy; forward to Candid Labs with rate‑limited credentials.
- Deploy the Paymaster proxy to staging today; share test URL in Slack for frontend validation.
- Set up Loki‑based alerts for “job process tx webhook is already running” log; route alerts to Slack for quick restarts.
- Merge MongoDB driver PR (adds maxTimeMS, maxCommitTimeMS, abort controller support) and upgrade to Mongo 5.0+.
- Add global maxPoolSize and socketTimeoutMS to Mongo client config; enforce per‑worker limits.
- Create separate tickets: (1) add signature‑verification RPC method to each indexer repo, (2) integrate verification call in data‑shard service.
- Confirm availability of a Candid Labs API key; if missing, register a new account under the WDK org and store the key in Vault.
- Notify the team on Slack before restarting the proxy service for staging tests; include expected downtime window.

## Paymaster API Proxy

- Current public Candid Labs Paymaster endpoint is hitting rate limits.
- Plan: proxy the API through backend, similar to existing RPC node proxy.
- Use internal /proxy/paymaster URL; secure with managed token and rate limiting.
- Nicolette will start implementation; hand off to another engineer for testing if finished early.
- Deployment can be done via Firebase config without full app redeploy, but a quick release is acceptable.

## Production Incident Recap

- Swap failures on Spark screen traced to Paymaster API throttling; also appears in fee requests for send/cash‑out flows.
- George reproduced the issue consistently in production.
- Additional bug: “job process tx webhook is already running” caused data‑shard processors to hang, requiring manual restarts.

## Alerting & Monitoring

- Nicolas/Andrei to configure Loki alerts for the stuck‑job log; Slack notification will trigger a restart.
- Temporary safeguard: PR adds logic to cancel jobs running &gt;15‑30 min and restart them.
- Long‑term: need driver‑level timeouts and connection health checks (cron job) to detect Mongo hangs.

## MongoDB Connection Issues

- Observed up to \~3,000 open connections; likely due to default pool settings and retry loops.
- Action: review and lower default pool size, enforce a global maxPoolSize per worker.
- Enable socketTimeoutMS and abort controller on cursor iterations to prevent indefinite hangs.
- Pending PR to upgrade Mongo driver to support abort controller; merge required before applying fixes.

## Signature Verification Workflow

- Backend will expose verification endpoint via WDK indexer RPC method.
- Frontend will later add signing support; backend flow remains unchanged.
- Decision: split work into two tickets (indexer RPC addition, data‑shard integration) to allow parallel progress.
- Await WDK team’s read‑only method release before final integration; if delay &gt;1 week, consider interim solution.

## Other Backend Updates

- FCM token and device‑ID change PR reviewed; expected release by end of week after testing.
- User‑ID augmentation (prefix “mob” + GUID) to be included in next release (v1.2.0).
- New endpoints for supported indexers and plasma contract integration being drafted; priority medium.
- Logger and CI/CD (GitHub Actions) setup tickets in progress; need access to configure Husky pre‑commit hooks.

## Upcoming Tasks & Ownership

- Alex to push PRs for measuring and testing on dev; tag team for feedback on analysis of stuck‑job issue.
- Usman to review and merge pending PRs (logger update, Mongo facility).
- Francisco to assign ownership for signature‑verification tickets; coordinate handoff next week.
- Nicolas to confirm Candid Labs API key location and share with team.
- Team to continue splitting large tasks into smaller tickets for better throughput.
